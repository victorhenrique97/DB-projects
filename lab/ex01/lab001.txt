
-- Victor Henrique de Souza Rodrigues 9791027

CREATE TABLE TIME (
        NOME VARCHAR2(100) NOT NULL,
        ESTADO CHAR(2),
        TIPO VARCHAR2(12) NOT NULL,
        SALDOGOLS NUMBER DEFAULT 0,
        
        CONSTRAINT PK_TIME PRIMARY KEY (NOME),
        CONSTRAINT CK_TIPO CHECK(UPPER(TIPO) IN ('AMADOR', 'PROFISSIONAL'))
    );

CREATE TABLE JOGA(
        TIME1 VARCHAR2(100) NOT NULL,
        TIME2 VARCHAR2(100) NOT NULL,
        CLASSICO CHAR(1) NOT NULL,
       
        CONSTRAINT PK_JOGA PRIMARY KEY (TIME1, TIME2),
        CONSTRAINT FK1_JOGA FOREIGN KEY (TIME1) REFERENCES TIME(NOME) ON DELETE CASCADE,
        CONSTRAINT FK2_JOGA FOREIGN KEY (TIME2) REFERENCES TIME(NOME) ON DELETE CASCADE,
        CONSTRAINT CK_CLASSICO CHECK (UPPER(CLASSICO) IN ('Y', 'N'))
    );

CREATE TABLE PARTIDA(  
        TIME1 VARCHAR2(100) NOT NULL,
        TIME2 VARCHAR2(100) NOT NULL,
        DATA DATE NOT NULL,
        PLACAR CHAR(3) DEFAULT '0X0',
        LOCAL VARCHAR2(50) NOT NULL,
        
        CONSTRAINT PK_PARTIDA PRIMARY KEY (TIME1, TIME2, DATA),
        CONSTRAINT FK_PARTIDA FOREIGN KEY(TIME1, TIME2) REFERENCES JOGA(TIME1, TIME2) ON DELETE CASCADE,
        CONSTRAINT CK_PLACAR CHECK (PLACAR LIKE '_X_')
    );

CREATE TABLE JOGADOR(
        CPF CHAR(11) NOT NULL,
        RG CHAR(9) NOT NULL,
        NOME VARCHAR2(100) NOT NULL,
        DATANASC DATE,
        NATURALIDADE VARCHAR2(20), 
        TIME VARCHAR2(100) NOT NULL,
        
        CONSTRAINT PK_JOGADOR PRIMARY KEY(CPF),
        CONSTRAINT SK_JOGADOR UNIQUE(NOME, RG),
        CONSTRAINT FK_JOGADOR FOREIGN KEY(TIME) REFERENCES TIME(NOME) ON DELETE CASCADE
);


CREATE TABLE POSICAOJOGADOR(
    JOGADOR CHAR(11) NOT NULL,
    POSICAO VARCHAR2(20) NOT NULL,
    
    CONSTRAINT PK_POSICAOJOGADOR PRIMARY KEY(JOGADOR, POSICAO),
    CONSTRAINT FK_POSICAOJOGADOR FOREIGN KEY(JOGADOR) REFERENCES JOGADOR(CPF) ON DELETE CASCADE
    
);

CREATE TABLE DIRETOR (
    TIME VARCHAR2(100) NOT NULL,
    NOME VARCHAR2(100) NOT NULL,
    
    CONSTRAINT PK_DIRETOR PRIMARY KEY(TIME, NOME),
    CONSTRAINT FK_DIRETOR FOREIGN KEY(TIME) REFERENCES TIME(NOME) ON DELETE CASCADE
);

CREATE TABLE UNIFORME (
    TIME VARCHAR2(100) NOT NULL,
    TIPO CHAR(7) NOT NULL,
    CORPRINCIPAL VARCHAR2(20) NOT NULL,
    
    CONSTRAINT PK_UNIFORME PRIMARY KEY(TIME, TIPO),
    CONSTRAINT SK_UNIFORME FOREIGN KEY(TIME) REFERENCES TIME(NOME) ON DELETE CASCADE,
    CONSTRAINT CK_TIPO CHECK (UPPER(TIPO) IN ('TITULAR', 'RESERVA'))
    
); 

INSERT INTO TIME(NOME, ESTADO, TIPO, SALDOGOLS) VALUES ('Corinthians', 'SP', 'profissional', 100);
INSERT INTO TIME(NOME, ESTADO, TIPO, SALDOGOLS) VALUES ('Fluminense', 'SP', 'BOM', '100');
INSERT INTO TIME(NOME, ESTADO, TIPO, SALDOGOLS) VALUES ('Fluminense', 'RJ', 'AMADOR', -100);
INSERT INTO JOGA(TIME1, TIME2, CLASSICO) VALUES ('Fluminense', 'QQQQQQQ', 'Y');
INSERT INTO JOGA(TIME1, TIME2, CLASSICO) VALUES ('Fluminense', 'Corinthians', 'a');
INSERT INTO JOGA(TIME1, TIME2, CLASSICO) VALUES ('Fluminense', 'Corinthians', 'N');
INSERT INTO PARTIDA (TIME1, TIME2, DATA, PLACAR ,LOCAL) VALUES ('Fluminense', 'Corinthians', '21-MAY-97', '9X0', 'Arena Corinthians');
INSERT INTO JOGADOR values (11111111111, 111111111, 'Geurgas', '30-JAN-90', 'Paulista', 'Corinthians');
INSERT INTO JOGADOR VALUES (11111111111, 222222222, 'Tico Liro', '20-NOV-65', 'Brasileiro', 'Fluminense');
INSERT INTO JOGADOR VALUES (11111511111, 222222222, 'Tico Liro', '20-NOV-65', 'Brasileiro', 'Fluminense');
INSERT INTO POSICAOJOGADOR VALUES (11111111111, 'Atacante');
INSERT INTO DIRETOR VALUES('Fluminense', 'Gustavo');
INSERT INTO UNIFORME VALUES ('Corinthians', 'titular', 'Preto');

ALTER TABLE UNIFORME DROP COLUMN CORPRINCIPAL;
ALTER TABLE UNIFORME ADD CORES VARCHAR2(100); -- assumi que as cores seria uma string de 100 caracteres com as cores
ALTER TABLE JOGADOR ADD ENDERECO VARCHAR2(100); --na consulta o campo endereco que ja havia ficou nulo
ALTER TABLE PARTIDA ADD DESCRICAO VARCHAR2(100) DEFAULT 'Sem nenhuma descricao adcional'; --as tabelas que ja existiam foram setadas com o valor default
ALTER TABLE JOGADOR DROP COLUMN CPF; -- nao permitiu executar o comando
ALTER TABLE JOGADOR DROP COLUMN CPF CASCADE CONSTRAINTS; -- ele removeu as contraints de chave primaria da tabela e permitiu a insercao de novos elementos que nao estao na tabela de jogador, alem disso, ele nao removeu o valor do cpf dos jogadores que ja existiam ao executar esse comando logo ele apenas removeu a chave estrangeira de posicaojogador e a chave primaria de jogador. 

INSERT INTO POSICAOJOGADOR VALUES (33333333333, 'Reserva'); -- permitiu a insercao o que nao era para permitir no modelo original



